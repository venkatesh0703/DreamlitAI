<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DreamlitAI - Premium AI Image Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6366f1">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f5f3ff',
                            100: '#ede9fe',
                            200: '#ddd6fe',
                            300: '#c4b5fd',
                            400: '#a78bfa',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            700: '#6d28d9',
                            800: '#5b21b6',
                            900: '#4c1d95',
                        }
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'wave': 'wave 1.5s ease-in-out infinite',
                        'pulse-slow': 'pulse 2.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        wave: {
                            '0%, 100%': { transform: 'rotate(0deg)' },
                            '25%': { transform: 'rotate(5deg)' },
                            '75%': { transform: 'rotate(-5deg)' },
                        },
                        bounce: {
                            '0%, 100%': { 
                                transform: 'translateY(-25%)',
                                'animation-timing-function': 'cubic-bezier(0.8,0,1,1)'
                            },
                            '50%': { 
                                transform: 'none',
                                'animation-timing-function': 'cubic-bezier(0,0,0.2,1)'
                            }
                        },
                        fadeInUp: {
                            '0%': { 
                                opacity: '0', 
                                transform: 'translateY(20px)'
                            },
                            '100%': { 
                                opacity: '1', 
                                transform: 'translateY(0)'
                            }
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/ui@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-gray-50 to-indigo-50 dark:bg-gradient-to-br dark:from-gray-900 dark:to-gray-800 h-screen overflow-hidden">
<div x-data="imageGenApp()" x-init="init()" class="flex flex-col h-screen">
    
    <!-- Fixed Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/98 dark:bg-gray-900/98 backdrop-blur-xl border-b border-gray-200/60 dark:border-gray-700/60 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-500 dark:to-purple-500 p-3 rounded-2xl shadow-lg">
                        <i class="fas fa-palette text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl lg:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-300 dark:to-purple-300">
                            DreamlitAI
                        </h1>
                        <p class="text-sm text-gray-600 dark:text-gray-300 hidden sm:block font-medium">Premium AI Image Generator</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-3">
                    <!-- Current Settings Display -->
                    <div class="hidden lg:flex items-center gap-4 mr-6">
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-semibold text-gray-700 dark:text-gray-200">Style:</span>
                            <span x-text="selectedStyle || 'None'" 
                                  class="px-3 py-1.5 bg-indigo-100 dark:bg-indigo-900/70 text-indigo-800 dark:text-indigo-200 rounded-full text-sm font-medium truncate max-w-32 border border-indigo-200 dark:border-indigo-700"></span>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="text-sm font-semibold text-gray-700 dark:text-gray-200">Model:</span>
                            <span x-text="selectedModel || 'flux'" 
                                  class="px-3 py-1.5 bg-purple-100 dark:bg-purple-900/70 text-purple-800 dark:text-purple-200 rounded-full text-sm font-medium border border-purple-200 dark:border-purple-700"></span>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <button @click="showSettings = !showSettings" 
                            :class="{'bg-indigo-600 text-white shadow-lg': showSettings, 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200': !showSettings}"
                            class="p-3 rounded-xl hover:bg-indigo-500 hover:text-white dark:hover:bg-indigo-500 transition-all duration-300 shadow-md">
                        <i class="fas fa-cog text-lg"></i>
                    </button>
                    <button @click="darkMode = !darkMode" 
                            class="p-3 rounded-xl bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-yellow-100 dark:hover:bg-yellow-900 hover:text-yellow-600 dark:hover:text-yellow-400 transition-all duration-300 shadow-md">
                        <i x-show="!darkMode" class="fas fa-moon text-lg"></i>
                        <i x-show="darkMode" class="fas fa-sun text-lg"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Collapsible Settings Panel -->
        <div x-show="showSettings" 
             x-transition:enter="transition ease-out duration-500 transform"
             x-transition:enter-start="opacity-0 -translate-y-4 scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 scale-100"
             x-transition:leave="transition ease-in duration-300 transform"
             x-transition:leave-start="opacity-100 translate-y-0 scale-100"
             x-transition:leave-end="opacity-0 -translate-y-4 scale-95"
             class="border-t-2 border-gradient-to-r from-indigo-200 to-purple-200 dark:from-indigo-700 dark:to-purple-700 bg-gradient-to-br from-gray-50/98 via-white/98 to-indigo-50/98 dark:from-gray-800/98 dark:via-gray-900/98 dark:to-indigo-900/98 backdrop-blur-2xl shadow-2xl">
            <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-6 max-h-[calc(100vh-6rem)] sm:max-h-[calc(100vh-8rem)] lg:max-h-[calc(100vh-10rem)] overflow-y-auto settings-scroll pb-8">
                
                <!-- Quick Settings Row - Single Row Layout -->
                <div class="flex flex-wrap items-center justify-between gap-6 mb-8 p-6 bg-gradient-to-r from-white/80 to-gray-50/80 dark:from-gray-800/80 dark:to-gray-900/80 rounded-3xl border border-gray-200/50 dark:border-gray-700/50 backdrop-blur-sm shadow-lg">
                    <!-- Active Style & Model Display -->
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-pink-500/20 to-rose-500/20 dark:from-pink-600/30 dark:to-rose-600/30 rounded-xl border border-pink-300/50 dark:border-pink-500/50">
                            <i class="fas fa-paint-brush text-pink-600 dark:text-pink-400 text-sm"></i>
                            <span class="text-gray-800 dark:text-gray-100 font-medium text-sm" x-text="selectedStyle || 'No Style'"></span>
                        </div>
                        <div class="flex items-center space-x-2 px-3 py-2 bg-gradient-to-r from-blue-500/20 to-cyan-500/20 dark:from-blue-600/30 dark:to-cyan-600/30 rounded-xl border border-blue-300/50 dark:border-blue-500/50">
                            <i class="fas fa-brain text-blue-600 dark:text-blue-400 text-sm"></i>
                            <span class="text-gray-800 dark:text-gray-100 font-medium text-sm" x-text="selectedModel || 'No Model'"></span>
                        </div>
                    </div>
                    
                    <!-- Enhanced Quality Toggle -->
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center cursor-pointer group" @click="quality = !quality">
                            <div class="relative">
                                <div class="block bg-gradient-to-r from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 w-14 h-7 rounded-full shadow-inner transition-all duration-300" :class="{'from-indigo-500 to-indigo-600 dark:from-indigo-500 dark:to-indigo-600': quality}">
                                    <div class="absolute left-0.5 top-0.5 bg-white w-6 h-6 rounded-full transition-all duration-300 transform shadow-md flex items-center justify-center" :class="{'translate-x-7': quality}">
                                        <i class="fas fa-sparkles text-xs transition-colors" :class="quality ? 'text-indigo-600' : 'text-gray-400'"></i>
                                    </div>
                                </div>
                            </div>
                            <span class="ml-3 text-gray-800 dark:text-gray-100 font-semibold text-sm group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">Enhanced Quality</span>
                        </div>
                    </div>
                    
                    <!-- HDR Mode Toggle -->
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center cursor-pointer group" @click="hdr = !hdr">
                            <div class="relative">
                                <div class="block bg-gradient-to-r from-gray-300 to-gray-400 dark:from-gray-600 dark:to-gray-700 w-14 h-7 rounded-full shadow-inner transition-all duration-300" :class="{'from-purple-500 to-purple-600 dark:from-purple-500 dark:to-purple-600': hdr}">
                                    <div class="absolute left-0.5 top-0.5 bg-white w-6 h-6 rounded-full transition-all duration-300 transform shadow-md flex items-center justify-center" :class="{'translate-x-7': hdr}">
                                        <i class="fas fa-bolt text-xs transition-colors" :class="hdr ? 'text-purple-600' : 'text-gray-400'"></i>
                                    </div>
                                </div>
                            </div>
                            <span class="ml-3 text-gray-800 dark:text-gray-100 font-semibold text-sm group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">HDR Mode</span>
                        </div>
                    </div>
                    
                    <!-- Apply Settings Button -->
                    <button @click="showSettings = false" 
                            class="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white rounded-2xl transition-all duration-300 text-sm font-semibold shadow-lg hover:shadow-xl flex items-center space-x-2 cursor-pointer">
                        <i class="fas fa-check text-sm"></i>
                        <span>Apply</span>
                    </button>
                </div>
                
                <!-- Style Selection -->
                <div class="mb-4">
                    <label class="block text-lg font-bold text-gray-900 dark:text-gray-50 mb-3 flex items-center">
                        <div class="bg-gradient-to-r from-pink-500 to-rose-500 p-1.5 rounded-lg mr-2 shadow-md">
                            <i class="fas fa-paint-brush text-white text-sm"></i>
                        </div>
                        <span class="bg-gradient-to-r from-pink-600 to-rose-600 dark:from-pink-400 dark:to-rose-400 bg-clip-text text-transparent">Style Presets</span>
                    </label>
                    <div class="max-h-60 sm:max-h-72 lg:max-h-80 overflow-y-auto settings-scroll pr-1">
                        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-3">
                            <template x-for="category in style_categories" :key="category.category">
                                <template x-for="style in category.styles" :key="style.name">
                                    <div 
                                        @click="selectedStyle = style.name; " 
                                        :class="{'ring-2 ring-pink-500 dark:ring-pink-400 ring-offset-2 dark:ring-offset-gray-800 shadow-xl scale-105': selectedStyle === style.name}"
                                        class="bg-white dark:bg-gray-800 cursor-pointer rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex flex-col overflow-hidden group relative transform hover:scale-105 border border-gray-200/50 dark:border-gray-700/50 h-40">
                                        <div class="flex-1 w-full overflow-hidden flex items-center justify-center bg-gradient-to-br from-pink-50 to-rose-100 dark:from-pink-900/20 dark:to-rose-900/20 relative">
                                            <img :src="style.image || `/static/style_images/${style.name.toLowerCase().replace(/\s+/g, '_')}.jfif`" 
                                                 :alt="style.name" 
                                                 @error="setDefaultImage($event, 'style')"
                                                 class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
                                            <div x-show="selectedStyle === style.name" 
                                                 x-transition:enter="transition ease-out duration-200"
                                                 x-transition:enter-start="opacity-0 scale-0"
                                                 x-transition:enter-end="opacity-100 scale-100"
                                                 class="absolute top-1 right-1 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-full p-1 shadow-lg">
                                                <i class="fas fa-heart text-xs"></i>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-gradient-to-b from-white to-gray-50 dark:from-gray-800 dark:to-gray-900">
                                            <span x-text="style.name" class="text-center font-medium text-sm text-gray-900 dark:text-gray-50 line-clamp-2 leading-tight group-hover:text-pink-600 dark:group-hover:text-pink-400 transition-colors duration-300"></span>
                                        </div>
                                    </div>
                                </template>
                            </template>
                        </div>
                    </div>
                </div>
                
                <!-- Model Selection -->
                <div>
                    <label class="block text-lg font-bold text-gray-900 dark:text-gray-50 mb-3 flex items-center">
                        <div class="bg-gradient-to-r from-blue-500 to-cyan-500 p-1.5 rounded-lg mr-2 shadow-md">
                            <i class="fas fa-brain text-white text-sm"></i>
                        </div>
                        <span class="bg-gradient-to-r from-blue-600 to-cyan-600 dark:from-blue-400 dark:to-cyan-400 bg-clip-text text-transparent">AI Models</span>
                    </label>
                    <div class="max-h-60 sm:max-h-72 lg:max-h-80 overflow-y-auto settings-scroll pr-1 pb-4">
                        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8 gap-3">
                            <template x-for="category in model_categories" :key="category.category">
                                <template x-for="model in category.models" :key="model.name">
                                    <div 
                                        @click="selectedModel = model.name;" 
                                        :class="{'ring-2 ring-blue-500 dark:ring-blue-400 ring-offset-2 dark:ring-offset-gray-800 shadow-xl scale-105': selectedModel === model.name}"
                                        class="bg-white dark:bg-gray-800 cursor-pointer rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex flex-col overflow-hidden group relative transform hover:scale-105 border border-gray-200/50 dark:border-gray-700/50 h-40">
                                        <div class="flex-1 w-full overflow-hidden flex items-center justify-center bg-gradient-to-br from-blue-50 to-cyan-100 dark:from-blue-900/20 dark:to-cyan-900/20 relative">
                                            <img :src="`/static/models/${model.name}.jpg`" 
                                                 :alt="model.name" 
                                                 @error="setDefaultImage($event, 'model', model.name)"
                                                 class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-50 group-hover:opacity-30 transition-opacity duration-300"></div>
                                            <div x-show="selectedModel === model.name" 
                                                 x-transition:enter="transition ease-out duration-200"
                                                 x-transition:enter-start="opacity-0 scale-0"
                                                 x-transition:enter-end="opacity-100 scale-100"
                                                 class="absolute top-1 right-1 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-full p-1 shadow-lg">
                                                <i class="fas fa-star text-xs"></i>
                                            </div>
                                        </div>
                                        <div class="p-2 bg-gradient-to-b from-white to-gray-50 dark:from-gray-800 dark:to-gray-900">
                                            <span x-text="model.display_name || model.name" class="text-center font-medium text-sm text-gray-900 dark:text-gray-50 line-clamp-2 leading-tight group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-300"></span>
                                        </div>
                                    </div>
                                </template>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Chat Container (Scrollable) -->
    <main class="flex-1 pt-20 pb-24 overflow-hidden" :class="{'pt-44': showSettings, 'lg:pt-52': showSettings}">
        <div class="w-full h-[97%] px-2 sm:px-4 lg:px-6">
            <div class="h-[97%] bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl rounded-t-3xl shadow-2xl border-2 border-gray-200/60 dark:border-gray-700/60 overflow-hidden">
                <div class="h-[97%] overflow-y-auto p-6 space-y-6 chat-container" x-ref="chatContainer">
                    <template x-for="(msg, idx) in chatMessages" :key="idx">
                        <div class="animate__animated" 
                             :class="{
                                 'animate__fadeIn': msg.type === 'user' || msg.type === 'bot' || msg.type === 'error',
                                 'animate-fade-in-up': msg.type === 'image',
                                 'animate__pulse animate__infinite': msg.type === 'loading'
                             }">
                            <template x-if="msg.type === 'user'">
                                <div class="flex justify-end">
                                    <div class="relative group cursor-pointer transition-all duration-300 hover:scale-105 hover:z-10 min-h-32 bg-gradient-to-r from-indigo-500 to-purple-500 dark:from-indigo-600 dark:to-purple-600 text-white rounded-3xl p-5 max-w-xs sm:max-w-lg ml-auto shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02] animate__animated animate__fadeInRight overflow-hidden">
                                        <span x-text="msg.content" class="break-words word-wrap text-base leading-relaxed font-medium block pr-2 overflow-wrap-anywhere"></span>
                                        <button @click.stop="startEditPromptFromUser(idx)" class="absolute top-4 right-4 bg-white hover:bg-yellow-100 text-gray-800 hover:text-gray-900 rounded-full p-2 shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-300 transform hover:scale-110 z-20 border-2 border-gray-300">
                                            <i class="fas fa-edit text-base"></i>
                                        </button>
                                        <div class="text-sm opacity-90 mt-3 text-right font-medium" x-text="msg.timestamp"></div>
                                </div>
                            </template>
                            
                            <template x-if="msg.type === 'image'">
                                <div class="flex justify-start w-full">
                                    <div class="bg-white/98 dark:bg-gray-800/98 backdrop-blur-xl border-2 border-gray-200/60 dark:border-gray-600/60 rounded-3xl p-4 w-full max-w-2xl shadow-2xl group animate-fade-in-up">
                                        <div class="mb-3 text-sm text-indigo-700 dark:text-indigo-300 font-semibold line-clamp-2 leading-relaxed" x-text="msg.prompt"></div>
                                        <div class="relative w-full" style="height: unset;">
                                            <img :src="msg.content" alt="Generated" class="generated-image rounded-2xl shadow-xl cursor-pointer w-full object-contain bg-gray-50 dark:bg-gray-800" style="height: unset;" @click="showModal = true; generatedImage = msg.content">
                                            <button @click.stop="startEditPrompt(idx)" class="absolute top-3 right-3 bg-white dark:bg-gray-900 hover:bg-yellow-100 dark:hover:bg-yellow-300 text-gray-800 dark:text-white hover:text-gray-900 dark:hover:text-gray-900 rounded-full p-2 shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-300 border border-gray-200 dark:border-gray-500 z-10">
                                                <i class="fas fa-edit text-sm"></i>
                                            </button>
                                        </div>
                                        <div class="mt-3 text-xs text-gray-600 dark:text-gray-400 font-medium" x-text="msg.timestamp"></div>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="msg.type === 'bot'">
                                <div class="flex justify-start">
                                    <div class="bg-gray-100/95 dark:bg-gray-700/95 backdrop-blur-xl text-gray-800 dark:text-gray-100 rounded-3xl p-5 max-w-xs sm:max-w-lg shadow-xl hover:shadow-2xl transition-all duration-300 animate__animated animate__fadeInLeft transform hover:scale-[1.01] overflow-hidden">
                                        <span x-text="msg.content" class="break-words word-wrap text-base leading-relaxed font-medium block overflow-wrap-anywhere"></span>
                                        <div class="text-sm opacity-80 mt-3 font-medium text-gray-600 dark:text-gray-300" x-text="msg.timestamp"></div>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="msg.type === 'error'">
                                <div class="flex justify-start">
                                    <div class="bg-red-50/95 dark:bg-red-900/30 backdrop-blur-xl border-2 border-red-200 dark:border-red-700 text-red-800 dark:text-red-200 rounded-3xl p-5 max-w-xs sm:max-w-lg shadow-xl hover:shadow-2xl transition-all duration-300 animate__animated animate__shakeX transform hover:scale-[1.01]">
                                        <div class="flex items-center mb-2">
                                            <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 mr-3 text-lg"></i>
                                            <span class="font-semibold text-base">Error</span>
                                        </div>
                                        <span x-text="msg.content" class="break-words text-base leading-relaxed font-medium"></span>
                                        <div class="text-sm opacity-80 mt-3 font-medium text-red-600 dark:text-red-300" x-text="msg.timestamp"></div>
                                    </div>
                                </div>
                            </template>
                            
                            <template x-if="msg.type === 'loading'">
                                <div class="flex justify-start">
                                    <div class="bg-white/98 dark:bg-gray-800/98 backdrop-blur-xl border-2 border-gray-200/60 dark:border-gray-600/60 rounded-3xl p-6 max-w-xs sm:max-w-lg shadow-xl hover:shadow-2xl transition-all duration-300 flex items-center gap-4">
                                        <div class="flex space-x-2">
                                            <div class="w-3 h-3 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full animate-pulse-slow"></div>
                                            <div class="w-3 h-3 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full animate-pulse-slow" style="animation-delay: 0.2s"></div>
                                            <div class="w-3 h-3 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full animate-pulse-slow" style="animation-delay: 0.4s"></div>
                                        </div>
                                        <div class="flex items-center">
                                            <i class="fas fa-magic text-indigo-600 dark:text-indigo-400 mr-3 text-lg animate-pulse"></i>
                                            <span class="text-gray-800 dark:text-gray-100 font-semibold text-base">Creating your masterpiece...</span>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Fixed Bottom Input -->
    <footer class="fixed bottom-0 left-0 right-0 z-40 bg-white/98 dark:bg-gray-900/98 backdrop-blur-xl border-t-2 border-gray-200/60 dark:border-gray-700/60 shadow-2xl safe-area-bottom">
        <div class="w-full px-2 sm:px-4 lg:px-6 py-6">
            <div class="flex items-center gap-4">
                <div class="relative flex-1">
                    <span class="absolute left-6 top-1/2 -translate-y-1/2 text-indigo-600 dark:text-indigo-400 animate-pulse">
                        <i class="fas fa-magic text-xl"></i>
                    </span>
                    <input x-model="currentMessage"
                           @keydown.enter="sendMessage()"
                           class="w-full pl-16 pr-20 py-5 rounded-3xl border-2 border-gray-200 dark:border-gray-600 focus:ring-4 focus:ring-indigo-200 dark:focus:ring-indigo-800 focus:border-indigo-500 dark:focus:border-indigo-400 shadow-xl hover:shadow-2xl transition-all duration-300 backdrop-blur-xl bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 text-lg font-medium"
                           placeholder="Describe your vision... (e.g., A majestic dragon soaring over a cyberpunk city at sunset)"
                           :disabled="isGenerating">
                    <button @click="sendMessage()"
                            :disabled="!currentMessage.trim() || isGenerating"
                            class="absolute right-3 top-1/2 -translate-y-1/2 bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-500 dark:to-purple-500 text-white p-4 rounded-2xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-xl cursor-pointer">
                        <i x-show="!isGenerating" class="fas fa-wand-magic-sparkles text-xl"></i>
                        <i x-show="isGenerating" class="fas fa-circle-notch animate-spin text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Modal for full image -->
    <div x-show="showModal" x-cloak 
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4" @click="showModal = false">
        <div class="relative animate__animated animate__zoomIn">
            <img :src="generatedImage" class="max-w-[95vw] max-h-[95vh] object-contain rounded-xl shadow-2xl" @click.stop>
            <div class="absolute bottom-4 right-4 flex gap-2">
                <button @click="downloadImage(generatedImage, 'generated-image-' + Date.now())" class="p-3 bg-white/90 dark:bg-gray-800/90 hover:bg-white dark:hover:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-full shadow-lg flex items-center justify-center group animate__animated animate__fadeIn">
                    <i class="fas fa-download group-hover:animate-bounce"></i>
                </button>
                <button @click="showModal = false" class="p-3 bg-white/90 dark:bg-gray-800/90 hover:bg-white dark:hover:bg-gray-700 text-gray-800 dark:text-gray-100 rounded-full shadow-lg">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notification Toast -->
    <div x-show="notification" x-transition:enter="animate__animated animate__fadeInRight" 
         x-transition:leave="animate__animated animate__fadeOutRight"
         class="fixed top-20 right-4 z-[100] bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm border border-green-200 dark:border-green-800 shadow-xl rounded-xl px-4 py-3 text-green-700 dark:text-green-300 font-medium flex items-center space-x-2 max-w-xs animate__animated animate__bounceIn">
        <i class="fas fa-check-circle text-green-500 dark:text-green-400"></i>
        <span x-text="notification"></span>
    </div>
</div>

<script>
    window.style_categories = {{ style_categories|tojson }};
    window.models = {{ models|tojson }};
    window.model_categories = {{ model_categories|tojson }};
    
    // Debug: Log the data to console
    console.log('Style categories:', window.style_categories);
    console.log('Model categories:', window.model_categories);
    console.log('Models dict:', window.models);
    
    // Force cache bust
    console.log('Template updated at:', new Date().toISOString());
</script>
<script src="/static/app.js"></script>
</body>
</html>